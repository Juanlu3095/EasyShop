import{a as h}from"./chunk-5MEYV43G.js";import{c as K}from"./chunk-YK5JBHKT.js";import{a as ce}from"./chunk-42JTQIQS.js";import"./chunk-BJKW2MZI.js";import"./chunk-5V7AZGGS.js";import{b as X}from"./chunk-JI4B56LL.js";import"./chunk-Y4ZCGVAW.js";import{c as Q,d as W}from"./chunk-3TBXM6QS.js";import{a as H,b as se,g as J,h as $}from"./chunk-7ITRIRQH.js";import{a as S}from"./chunk-PE3AIABI.js";import{b as y,c as me,d as b,e as D,f as x,g as E,h as w}from"./chunk-SMOEXM7I.js";import{b as B,d as _,f as j,g as O,h as G,j as q,k as V,m as L,n as P,s as R,t as z,u as U}from"./chunk-33HZCSPU.js";import{d as le}from"./chunk-V6CHNUWL.js";import{o as u,q as f}from"./chunk-UKCT2NNU.js";import"./chunk-AESYL7IM.js";import"./chunk-YRYHB4P2.js";import"./chunk-I7KWM6MY.js";import{i as ae}from"./chunk-X2X7HICG.js";import{Ab as a,Bb as r,Cb as N,Gb as A,Jb as c,Lb as k,Mc as re,Vb as l,Xb as ne,Ya as m,Za as s,cc as p,ga as oe,la as d,ob as C,qb as v,ua as I,va as T,vb as g}from"./chunk-BEZRA2BD.js";function we(o,i){if(o&1){let F=A();a(0,"mat-dialog-content"),l(1," \xBFEst\xE1s seguro de que quieres eliminar las suscripciones seleccionadas? "),N(2,"br"),a(3,"span",1),l(4,"\xA1OJO! Si has pulsado el bot\xF3n para seleccionar todo, se eliminar\xE1n todos las suscripciones, incluidas aquellas que no aparezcan en la vista actual."),r()(),a(5,"mat-dialog-actions",2)(6,"button",3),l(7,"No"),r(),a(8,"button",4),c("click",function(){I(F);let t=k();return T(t.eliminarSeleccionados())}),l(9,"S\xED"),r()()}}function ge(o,i){o&1&&(a(0,"mat-dialog-content"),l(1," No hay registros seleccionados. "),N(2,"br"),r(),a(3,"mat-dialog-actions",2)(4,"button",3),l(5,"Aceptar"),r()())}var de=(()=>{let i=class i{constructor(e,t,n){this.data=e,this.newsletterService=t,this._snackBar=n}ngOnInit(){console.log(this.data.ids)}eliminarSeleccionados(){this.newsletterService.deleteNewsletter(this.data.ids).subscribe({next:e=>{console.log(e),this._snackBar.open("Suscripciones a newsletter eliminadas.","Aceptar",{duration:3e3})},error:e=>{console.error(e)}})}};i.\u0275fac=function(t){return new(t||i)(s(y),s(h),s(S))},i.\u0275cmp=d({type:i,selectors:[["app-dasheliminarseleccionnewsletter"]],standalone:!0,features:[p],decls:4,vars:1,consts:[["mat-dialog-title",""],[1,"caution"],["align","end"],["mat-button","","mat-dialog-close",""],["mat-button","","mat-dialog-close","","cdkFocusInitial","",1,"aceptar",3,"click"]],template:function(t,n){t&1&&(a(0,"h2",0),l(1,"Eliminar mensajes seleccionados"),r(),C(2,we,10,0)(3,ge,6,0)),t&2&&(m(2),g(2,n.data.ids.length>0?2:3))},dependencies:[w,b,D,E,x,f,u],styles:[".caution[_ngcontent-%COMP%]{color:red}.aceptar[_ngcontent-%COMP%]{background-color:red;color:var(--white)}"]});let o=i;return o})();function _e(o,i){if(o&1&&(a(0,"form",2)(1,"mat-form-field",6)(2,"mat-label"),l(3,"Correo electr\xF3nico"),r(),N(4,"input",7),r()()),o&2){let F=k();v("formGroup",F.editarNewsletterForm)}}function Se(o,i){o&1&&(a(0,"p"),l(1,"La suscripci\xF3n a la que trata de acceder no existe."),r())}var pe=(()=>{let i=class i{constructor(e,t,n){this.data=e,this.newsletterService=t,this._snackBar=n,this.editarNewsletterForm=new G({email:new q("",_.compose([_.email,_.required]))})}ngOnInit(){this.getNewsletter(this.data.id)}getNewsletter(e){this.newsletterService.getNewsletter(e).subscribe({next:t=>{this.newsletter=t,console.log(t),this.editarNewsletterForm.patchValue({email:this.newsletter.Email})},error:t=>{console.error(t)}})}editarNewsletter(){this.newsletterService.updateNewsletter(this.data.id,this.editarNewsletterForm.value).subscribe({next:e=>{this._snackBar.open("Suscripci\xF3n a la newsletter editada.","Aceptar",{duration:3e3})},error:e=>{console.error(e)}})}};i.\u0275fac=function(t){return new(t||i)(s(y),s(h),s(S))},i.\u0275cmp=d({type:i,selectors:[["app-dasheditarnewsletter"]],standalone:!0,features:[p],decls:10,vars:2,consts:[["mat-dialog-title",""],[1,"mat-typography"],[1,"example-form",3,"formGroup"],["align","end"],["mat-button","","mat-dialog-close",""],["mat-button","","cdkFocusInitial","",3,"click","mat-dialog-close"],[1,"example-full-width"],["matInput","","placeholder","Ejemplo: pepe@gmail.com","formControlName","email","ngDefaultControl","","required",""]],template:function(t,n){t&1&&(a(0,"h2",0),l(1,"Editar suscripci\xF3n a newsletter"),r(),a(2,"mat-dialog-content",1),C(3,_e,5,1,"form",2)(4,Se,2,0),r(),a(5,"mat-dialog-actions",3)(6,"button",4),l(7,"Cancelar"),r(),a(8,"button",5),c("click",function(){return n.editarNewsletter()}),l(9,"Guardar"),r()()),t&2&&(m(3),g(3,n.newsletter?3:4),m(5),v("mat-dialog-close",!0))},dependencies:[w,b,D,E,x,f,u,$,J,H,K,W,Q,X,z,V,B,j,O,R,U,L,P],styles:[".example-form[_ngcontent-%COMP%]{min-width:150px;max-width:500px;width:100%}.example-full-width[_ngcontent-%COMP%]{width:100%}"]});let o=i;return o})();function be(o,i){if(o&1){let F=A();a(0,"mat-dialog-content"),l(1),r(),a(2,"mat-dialog-actions",1)(3,"button",2),l(4,"No"),r(),a(5,"button",3),c("click",function(){I(F);let t=k();return T(t.eliminarNewsletter())}),l(6,"S\xED"),r()()}if(o&2){let F=k();m(),ne(" \xBFEst\xE1s seguro de que quieres eliminar la suscripci\xF3n de ",F.newsletter.Email,"? ")}}function De(o,i){o&1&&(a(0,"mat-dialog-content")(1,"p"),l(2,"Cargando suscripci\xF3n..."),r()())}var ue=(()=>{let i=class i{constructor(e,t,n){this.data=e,this.newsletterService=t,this._snackBar=n}ngOnInit(){this.data.id&&this.getNewsletter(this.data.id)}getNewsletter(e){this.newsletterService.getNewsletter(e).subscribe({next:t=>{this.newsletter=t},error:t=>{console.error(t)}})}eliminarNewsletter(){this.newsletterService.deleteNewsletter(this.data.id).subscribe({next:e=>{this._snackBar.open("Suscripci\xF3n a la newsletter eliminada.","Aceptar",{duration:3e3})},error:e=>{console.error("Ha ocurrido un error:",e)}})}};i.\u0275fac=function(t){return new(t||i)(s(y),s(h),s(S))},i.\u0275cmp=d({type:i,selectors:[["app-dasheliminarnewsletter"]],standalone:!0,features:[p],decls:4,vars:1,consts:[["mat-dialog-title",""],["align","end"],["mat-button","","mat-dialog-close",""],["mat-button","","mat-dialog-close","","cdkFocusInitial","",1,"aceptar",3,"click"]],template:function(t,n){t&1&&(a(0,"h2",0),l(1,"Eliminar suscripci\xF3n a newsletter"),r(),C(2,be,7,1)(3,De,3,0)),t&2&&(m(2),g(2,n.newsletter?2:3))},dependencies:[w,b,D,E,x,f,u],styles:[".aceptar[_ngcontent-%COMP%]{background-color:red;color:var(--white)}"]});let o=i;return o})();function xe(o,i){o&1&&(a(0,"mat-error"),l(1,"Introduzca un email v\xE1lido."),r())}function Ee(o,i){o&1&&(a(0,"mat-error"),l(1,"El email es "),a(2,"strong"),l(3,"requerido."),r()())}var fe=(()=>{let i=class i{constructor(e,t){this.newsletterService=e,this._snackBar=t,this.newsletterForm=new G({email:new q("",_.compose([_.email,_.required]))})}postNewsletter(){this.newsletterForm.valid&&this.newsletterService.postNewsletter(this.newsletterForm.value).subscribe({next:e=>{this._snackBar.open("Suscripci\xF3n creada.","Aceptar",{duration:3e3})},error:e=>{console.error("Ha ocurrido un error",e)}})}};i.\u0275fac=function(t){return new(t||i)(s(h),s(S))},i.\u0275cmp=d({type:i,selectors:[["app-dashnuevanewsletter"]],standalone:!0,features:[p],decls:15,vars:4,consts:[["mat-dialog-title",""],[1,"mat-typography"],[1,"example-form",3,"formGroup"],[1,"example-full-width"],["matInput","","type","email","placeholder","Ejemplo: pepe@gmail.com","formControlName","email","required","","ngDefaultControl",""],["align","end"],["mat-button","","mat-dialog-close",""],["mat-button","","cdkFocusInitial","",3,"click","mat-dialog-close"]],template:function(t,n){t&1&&(a(0,"h2",0),l(1,"A\xF1adir suscripci\xF3n a la newsletter"),r(),a(2,"mat-dialog-content",1)(3,"form",2)(4,"mat-form-field",3)(5,"mat-label"),l(6,"Correo electr\xF3nico"),r(),N(7,"input",4),r(),C(8,xe,2,0,"mat-error")(9,Ee,4,0,"mat-error"),r()(),a(10,"mat-dialog-actions",5)(11,"button",6),l(12,"Cancelar"),r(),a(13,"button",7),c("click",function(){return n.postNewsletter()}),l(14,"Guardar"),r()()),t&2&&(m(3),v("formGroup",n.newsletterForm),m(5),g(8,n.newsletterForm.controls.email.hasError("email")&&!n.newsletterForm.controls.email.hasError("required")?8:-1),m(),g(9,n.newsletterForm.controls.email.hasError("required")?9:-1),m(4),v("mat-dialog-close",!0))},dependencies:[w,b,D,E,x,f,u,$,J,H,se,K,W,Q,X,z,V,B,j,O,R,U,L,P],styles:[".example-form[_ngcontent-%COMP%]{min-width:150px;max-width:500px;width:100%}.example-full-width[_ngcontent-%COMP%]{width:100%}"]});let o=i;return o})();var ct=(()=>{let i=class i{constructor(e,t,n){this.title=e,this.newsletterService=t,this.router=n,this.columns=["Email","Fecha"],this.displayedColumns=["select",...this.columns,"acciones"],this.selectedIds=[],this.botones=[{id:1,nombre:"Editar",class:"",accion:M=>this.openDialogEditarNewsletter(M)},{id:2,nombre:"Eliminar",class:"danger",accion:M=>this.openDialogEliminarNewsletter(M)}],this.dialog=oe(me)}ngOnInit(){this.title.setTitle("Newsletter < EasyShop"),this.getNewsletters(),this.suscripcion=this.newsletterService.refresh$.subscribe(()=>{this.getNewsletters()})}getNewsletters(){this.newsletterService.getNewsletters().subscribe({next:e=>{console.log(e),this.data=e},error:e=>{console.error(e)}})}openDialogNuevaNewsletter(){this.dialog.open(fe)}openDialogEditarNewsletter(e){this.dialog.open(pe,{data:{id:e}})}openDialogEliminarNewsletter(e){this.dialog.open(ue,{data:{id:e}})}onSelectionChange(e){this.selectedIds=e}openDialogEliminarSeleccionNewsletter(){this.dialog.open(de,{data:{ids:this.selectedIds}})}exportarNewsletter(){this.newsletterService.exportNewsletters().subscribe({next:e=>{let t=URL.createObjectURL(e),n=document.createElement("a");n.href=t,n.download="newsletters.xlsx",document.body.appendChild(n),n.click(),document.body.removeChild(n),window.URL.revokeObjectURL(t)},error:e=>{console.error(e)}})}};i.\u0275fac=function(t){return new(t||i)(s(ae),s(h),s(le))},i.\u0275cmp=d({type:i,selectors:[["app-dashboardnewsletter"]],standalone:!0,features:[p],decls:10,vars:5,consts:[[1,"encabezado-newsletter"],["mat-stroked-button","",3,"click"],[3,"selectionChange","columns","displayedColumns","data","buttons","eliminarSeleccionados"]],template:function(t,n){t&1&&(a(0,"main")(1,"section")(2,"div",0)(3,"h1"),l(4,"Newsletter"),r(),a(5,"button",1),c("click",function(){return n.openDialogNuevaNewsletter()}),l(6,"A\xF1adir nueva suscripci\xF3n"),r(),a(7,"button",1),c("click",function(){return n.exportarNewsletter()}),l(8,"Exportar registros"),r()(),a(9,"app-tablacompleta",2),c("selectionChange",function(he){return n.onSelectionChange(he)}),r()()()),t&2&&(m(9),v("columns",n.columns)("displayedColumns",n.displayedColumns)("data",n.data)("buttons",n.botones)("eliminarSeleccionados",n.openDialogEliminarSeleccionNewsletter.bind(n)))},dependencies:[ce,re,w,f,u],styles:[".encabezado-newsletter[_ngcontent-%COMP%]{display:flex;gap:1rem;margin-bottom:1rem}.encabezado-newsletter[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{border-color:var(--darkblue)}"]});let o=i;return o})();export{ct as DashboardnewsletterComponent};
