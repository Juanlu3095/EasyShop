import{a as Y}from"./chunk-4MKVII7L.js";import"./chunk-YUTX5S43.js";import"./chunk-2Z2WP37M.js";import"./chunk-BJKW2MZI.js";import"./chunk-5V7AZGGS.js";import"./chunk-JI4B56LL.js";import"./chunk-Y4ZCGVAW.js";import{c as K,d as Q}from"./chunk-3TBXM6QS.js";import{a as $,g as H,h as J}from"./chunk-7ITRIRQH.js";import{a as A}from"./chunk-VFELF6FW.js";import{a as U}from"./chunk-PE3AIABI.js";import{c as W,h as X}from"./chunk-SMOEXM7I.js";import{b as k,d as s,f as P,g as V,h as T,j as h,k as O,m as q,n as B,s as G,t as R,u as j}from"./chunk-33HZCSPU.js";import{b as y}from"./chunk-WR2FAY7X.js";import{o as L,q as z}from"./chunk-UKCT2NNU.js";import"./chunk-AESYL7IM.js";import"./chunk-YRYHB4P2.js";import"./chunk-I7KWM6MY.js";import{i as w,k as N}from"./chunk-XXO6A46Z.js";import{Ab as a,Bb as i,Cb as m,Gb as I,Jb as x,Lb as l,Va as D,Vb as r,Xb as S,Ya as d,Za as g,cc as F,ga as v,ib as M,la as E,ob as u,qb as b,ua as C,va as _,vb as p}from"./chunk-BEZRA2BD.js";function ee(t,n){if(t&1&&(a(0,"span"),r(1),i()),t&2){let o=l(2);d(),S(" Imagen: ",o.imagenElegida.nombre,"")}}function te(t,n){if(t&1&&(a(0,"h3"),r(1,"\xC9sta es la imagen asignada actualmente:"),i(),a(2,"p"),r(3),i(),m(4,"img",9)),t&2){let o=l(2);d(3),S("Nombre de la imagen: ",o.categoria.Imagen[0].Nombre_imagen,""),d(),b("src",o.FileEndpoint+o.categoria.Imagen[0].Ruta_archivo,D)("alt",o.categoria.Imagen[0].Alt)}}function ie(t,n){t&1&&(a(0,"p"),r(1,"La categor\xEDa no tiene una imagen asignada."),i())}function ae(t,n){if(t&1){let o=I();a(0,"div",2)(1,"form",3)(2,"mat-form-field",4)(3,"mat-label"),r(4,"Nombre"),i(),m(5,"input",5),i(),a(6,"mat-form-field",4)(7,"mat-label"),r(8,"Slug"),i(),m(9,"input",6),i(),a(10,"button",7),x("click",function(){C(o);let e=l();return _(e.openDialogSeleccionarImagen())}),r(11,"Seleccionar imagen"),i(),u(12,ee,2,1,"span"),m(13,"br")(14,"br"),a(15,"button",8),x("click",function(){C(o);let e=l();return _(e.editarProductCategory())}),r(16,"Guardar"),i()()(),a(17,"div",2),u(18,te,5,3)(19,ie,2,0),i()}if(t&2){let o=l();d(),b("formGroup",o.editarCategoriaForm),d(11),p(12,o.imagenSeleccionada()?12:-1),d(6),p(18,o.categoria.Imagen[0]?18:19)}}function oe(t,n){t&1&&(a(0,"p"),r(1,"La categor\xEDa a la que intentas acceder no existe."),i())}var Ee=(()=>{let n=class n{constructor(c,e,f,Z){this.productoService=c,this.router=e,this.title=f,this._snackBar=Z,this.FileEndpoint=N.DriveEndpoint,this.editarCategoriaForm=new T({nombre:new h("",s.required),slug:new h("",s.required),imagen_id:new h(0,s.compose([s.required,s.minLength(1)]))}),this.dialog=v(W),this.imagenSeleccionada=M("")}ngOnInit(){this.title.setTitle("Editar Categor\xEDa de producto < EasyShop"),this.idCategoria=this.router.snapshot.params.idcategoria,this.getProductCategory(this.idCategoria),this.suscripcion=this.productoService.refresh$.subscribe(()=>{this.getProductCategory(this.idCategoria)})}ngOnDestroy(){this.suscripcion.unsubscribe()}getProductCategory(c){this.productoService.getCategoria(c).subscribe({next:e=>{this.categoria=e.data,e.data.Imagen.length>0?(this.editarCategoriaForm.patchValue({nombre:this.categoria.Nombre,slug:this.categoria.Slug,imagen_id:this.categoria.Imagen[0].Id??0}),this.imagenElegida={id:this.categoria.Imagen[0].Id,nombre:this.categoria.Imagen[0].Nombre_imagen}):this.editarCategoriaForm.patchValue({nombre:this.categoria.Nombre,slug:this.categoria.Slug})},error:e=>{console.error(e)}})}editarProductCategory(){this.productoService.updateCategoria(this.idCategoria,this.editarCategoriaForm.value).subscribe({next:c=>{this._snackBar.open("Categor\xEDa editada.","Aceptar",{duration:3e3})},error:c=>{this._snackBar.open(c.error.result,"Aceptar",{duration:3e3})}})}openDialogSeleccionarImagen(){this.dialog.open(Y,{data:{imagenSeleccionada:{id:null,nombre:""}}}).afterClosed().subscribe(e=>{e!==void 0&&(this.imagenSeleccionada.set(e),this.imagenElegida=e,this.editarCategoriaForm.patchValue({imagen_id:this.imagenElegida.id}))})}};n.\u0275fac=function(e){return new(e||n)(g(A),g(y),g(w),g(U))},n.\u0275cmp=E({type:n,selectors:[["app-dashboardeditarcategoriaproducto"]],standalone:!0,features:[F],decls:11,vars:1,consts:[["href","dashboard/categoriasproducto"],[1,"data"],[1,"column-data"],[1,"example-form",3,"formGroup"],[1,"example-full-width"],["matInput","","placeholder","Nombre de la categor\xEDa","formControlName","nombre","ngDefaultControl","","required",""],["matInput","","placeholder","Slug de la categor\xEDa","formControlName","slug","ngDefaultControl","","required",""],["mat-flat-button","",1,"select-image",3,"click"],["mat-stroked-button","","type","submit",3,"click"],[3,"src","alt"]],template:function(e,f){e&1&&(a(0,"main")(1,"section")(2,"h1"),r(3,"Editar categor\xEDa de producto"),i(),a(4,"a",0),r(5,"\u2190 Volver a la p\xE1gina anterior"),i()(),m(6,"br")(7,"br"),a(8,"section",1),u(9,ae,20,3)(10,oe,2,0),i()()),e&2&&(d(9),p(9,f.categoria?9:10))},dependencies:[z,L,J,H,$,Q,K,X,j,O,k,P,V,G,q,B,R],styles:[".data[_ngcontent-%COMP%]{display:flex;gap:2rem}.column-data[_ngcontent-%COMP%]{width:50%}.column-data[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-width:400px}.example-form[_ngcontent-%COMP%]{min-width:150px;width:100%}.example-full-width[_ngcontent-%COMP%]{width:100%}.select-image[_ngcontent-%COMP%]{background-color:var(--darkblue);color:var(--white)}"]});let t=n;return t})();export{Ee as DashboardeditarcategoriaproductoComponent};
