import{a as F}from"./chunk-26UN3FU5.js";import{a as A}from"./chunk-2Z2WP37M.js";import"./chunk-BJKW2MZI.js";import"./chunk-5V7AZGGS.js";import"./chunk-JI4B56LL.js";import"./chunk-Y4ZCGVAW.js";import"./chunk-3TBXM6QS.js";import"./chunk-7ITRIRQH.js";import{a as T}from"./chunk-PE3AIABI.js";import{a as O}from"./chunk-2OGK3DXK.js";import"./chunk-SMOEXM7I.js";import"./chunk-33HZCSPU.js";import{d as B}from"./chunk-WR2FAY7X.js";import{o as I,q as w}from"./chunk-UKCT2NNU.js";import"./chunk-AESYL7IM.js";import"./chunk-YRYHB4P2.js";import"./chunk-I7KWM6MY.js";import{i as x}from"./chunk-XXO6A46Z.js";import{Ab as s,Bb as d,Cb as E,Gb as y,Jb as b,Lb as D,Rb as g,Sb as f,Tb as v,Vb as l,Xb as M,Ya as h,Za as a,cc as k,jc as _,la as S,ob as C,qb as P,ua as m,va as u}from"./chunk-BEZRA2BD.js";var Q=["contentEliminar"],R=["contentEliminarSeleccion"];function V(n,r){if(n&1&&(s(0,"div"),l(1),d()),n&2){let q=D();h(),M(' \xBFEst\xE1s seguro de querer eliminar el pedido de "',q.nombrePedido,'"? ')}}function j(n,r){n&1&&(s(0,"div"),l(1," \xBFEst\xE1s seguro de querer los pedidos seleccionados? "),E(2,"br"),s(3,"span",5),l(4,"\xA1OJO! Si has pulsado el bot\xF3n para seleccionar todo, se eliminar\xE1n todos los pedidos, incluidos aquellos que no aparezcan en la vista actual."),d()())}var W=(()=>{let r=class r{constructor(t,o,i,e,c){this.pedidoService=t,this.dialogService=o,this._snackBar=i,this.title=e,this.router=c,this.columns=["Id","Cliente","Estado","Total","Fecha"],this.displayedColumns=["select",...this.columns,"acciones"],this.selectedIds=[],this.botones=[{id:1,nombre:"Editar",class:"",accion:p=>this.editarPedido(p)},{id:2,nombre:"Eliminar",class:"danger",accion:p=>this.openDialogEliminarPedido(p)}]}ngOnInit(){this.title.setTitle("Pedidos < Easyshop"),this.getPedidos(),this.suscripcion=this.pedidoService.refresh$.subscribe(()=>{this.getPedidos()})}ngOnDestroy(){this.suscripcion.unsubscribe()}nuevoPedido(){this.router.navigate(["dashboard/nuevopedido"])}editarPedido(t){this.router.navigate(["dashboard/pedidos/",t])}openDialogEliminarPedido(t){let o="Eliminar producto",i="aceptar";this.pedidoService.getPedido(t).subscribe({next:e=>{console.log(e),this.nombrePedido=e.Cliente},error:e=>{console.error(e)}}),this.dialogService.openDialog(this.eliminarPedidoModal,o,i).then(e=>{if(e)this.pedidoService.deletePedido(t).subscribe({next:c=>{this._snackBar.open("Pedido eliminado.","Aceptar",{duration:3e3})},error:c=>{this._snackBar.open("Ha ocurrido un error.","Aceptar",{duration:3e3})}});else return})}onSelectionChange(t){this.selectedIds=t}eliminarSeleccionDialog(){this.dialogService.openDialog(this.eliminarSeleccionPedidoModal,"Eliminar pedidos seleccionados","aceptar").then(i=>{if(i)this.pedidoService.deletePedido(this.selectedIds).subscribe({next:e=>{this._snackBar.open("Pedidos eliminados.","Aceptar",{duration:3e3})},error:e=>{this._snackBar.open("Ha ocurrido un error.","Aceptar",{duration:3e3})}});else return})}getPedidos(){this.pedidoService.getPedidos().subscribe({next:t=>{this.pedidos=t.data},error:t=>{this._snackBar.open("No se ha podido obtener los pedidos.","Reintentar",{duration:3e3}).onAction().subscribe(()=>{this.getPedidos()})}})}};r.\u0275fac=function(o){return new(o||r)(a(F),a(O),a(T),a(x),a(B))},r.\u0275cmp=S({type:r,selectors:[["app-dashboardpedidos"]],viewQuery:function(o,i){if(o&1&&(g(Q,5),g(R,5)),o&2){let e;f(e=v())&&(i.eliminarPedidoModal=e.first),f(e=v())&&(i.eliminarSeleccionPedidoModal=e.first)}},standalone:!0,features:[k],decls:12,vars:5,consts:[["contentEliminar",""],["contentEliminarSeleccion",""],[1,"encabezado-pedidos"],["mat-stroked-button","",3,"click"],[3,"selectionChange","columns","displayedColumns","data","buttons","eliminarSeleccionados"],[1,"caution"]],template:function(o,i){if(o&1){let e=y();s(0,"main")(1,"section")(2,"div",2)(3,"h1"),l(4,"Pedidos"),d(),s(5,"button",3),b("click",function(){return m(e),u(i.nuevoPedido())}),l(6,"A\xF1adir pedido"),d()(),s(7,"app-tablacompleta",4),b("selectionChange",function(p){return m(e),u(i.onSelectionChange(p))}),d()()(),C(8,V,2,1,"ng-template",null,0,_)(10,j,5,0,"ng-template",null,1,_)}o&2&&(h(7),P("columns",i.columns)("displayedColumns",i.displayedColumns)("data",i.pedidos)("buttons",i.botones)("eliminarSeleccionados",i.eliminarSeleccionDialog.bind(i)))},dependencies:[A,w,I],styles:[".encabezado-pedidos[_ngcontent-%COMP%]{display:flex;gap:1rem;margin-bottom:1rem}.encabezado-pedidos[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{border-color:var(--darkblue)}.caution[_ngcontent-%COMP%]{color:red}"]});let n=r;return n})();export{W as DashboardpedidosComponent};
